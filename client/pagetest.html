<head>
    <title>pagetest</title>
    <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>
    {{> pageBody}}
</body>

<template name="pageBody">
    <header>
    <h3><i class="fa fa-dashboard"></i> Pagevamp Metrics Dashboard</h3>
    </header>
{{#if gLoading}}
{{> graphs}}
{{else}}
{{> loading}}
{{/if}}
</template>

<template name="graphs">
    <div class="body">
        <div class="row">
        {{> latestSites}}
        {{> latestCustomers}}
        </div>
        <div class="row">
            {{> weeklyVTP}}
        </div>
        <div class="row">
            {{> visitsMonth}}
            {{> visitsWeek}}
        </div>
        <div class="row">
            {{> stripeFailures}}
            {{> vampErrors}}
        </div>
    </div>
</template>

<template name="loading">
    loading..
</template>

<template name="onlineNow">
    <h2>On PageVamp now</h2>
    <h1>{{number}}</h1>
</template>

<template name="visitsWeek">
    <div class="card">
    <h2>Weekly Site Visits</h2>
        <h1>{{visits}}</h1>
    </div>
</template>

<template name="visitsMonth">
    <div class="card small">
    <h2>Monthly Site Visits</h2>
        <h1>{{visits}}</h1>
    </div>
</template>

<template name="vampErrors">
<div class="card sf-container">
    <h2>Latest PageVamp Errors</h2>
    <ul class="scroll-container">
        {{#each errors}}
        {{> vRow}}
        {{/each}}
    </ul>
</div>
</template>

<!-- vRow needs more work-->
<template name="vRow">
    <li class="page-row">
    <div class="inner-container">
        <div>{{pageid}}</div>
        <div>{{url}}</div>
        <div>{{message}}</div>
        <div>{{error_code}}</div>
        <div>{{timestamp}}</div>
    </div>
    </li>
</template>

<template name="stripeFailures">
<div class="card sf-container">
    <h2>Latest Stripe Failures</h2>
    <ul class="scroll-container">
        {{#each failures}}
        {{> sfRow}}
        {{/each}}
    </ul>
</div>
</template>

<template name="sfRow">
    <li class="page-row">
    <div class="inner-container">
        <div>{{firstname}} {{lastname}}</div>
        <div>{{email}}</div>
        <div>{{pageid}}</div>
        <div>{{reason}}</div>
        <div>{{transactionDate}}</div>
    </div>
    </li>
</template>

<template name="weeklyVTP">
    <div class="card">
        <div class="vtp-container">
        <h2>Weekly VTP</h2>
        <canvas height="400" width="800" id="weeklyVTP"></canvas>
        <div id="weeklyVTPLegend">
        </div>
    </div>
    </div>
</template>

<template name="latestCustomers">
<div class="card lc-container">
    <h2>Latest Paying Customers</h2>
    <ul class="scroll-container">
        {{#each subscriptions}}
        {{> lcRow}}
        {{/each}}
    </ul>
</div>
</template>

<template name="lcRow">
    <li class="page-row">
    <div class="inner-container">
        <div>{{firstname}} {{lastname}}</div>
        <div>{{email}}</div>
        <div>{{uid}}</div>
        <div>{{firstPayment}}</div>
        <div>{{nextPayment}}</div>
    </div>
<a target="_blank" href="https://pagevamp.com/page/{{pageid}}">
    <i class="fa fa-link"></i>
</a>
    </li>
</template>

<template name="latestSites">
<div class="card ls-container">
    <h2>Latest Published Sites</h2>
    <ul class="scroll-container">
        {{#each fbpages}}
        {{> lsPageRow}}
        {{/each}}
    </ul>
</div>
</template>

<template name="lsPageRow">
    <li class="page-row">
    <div class="inner-container">
        <div class="image">
            <img src="{{pic_square}}"/>
        </div>
        <div>{{name}}</div>
        <div>{{category}}</div>
        <div>{{pageid}}</div>
        <div>{{timestamp}}</div>
    </div>
<a target="_blank" href="https://pagevamp.com/page/{{pageid}}">
    <i class="fa fa-link"></i>
</a>
    </li>
</template>


<template name="login">
<button id="al">Log In to Analytics</button>
</template>

<template name="lineGraph">
<canvas id="lineGraph" width="400" height="400"></canvas>
</template>
